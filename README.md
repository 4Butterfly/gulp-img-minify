# Gulp Image Minify - AVIF поддержка

Этот проект обрабатывает изображения с помощью Gulp, включая полную поддержку AVIF файлов.

## Функции:

### Основные возможности:
- **Минификация изображений** - оптимизация JPG, PNG, GIF, SVG
- **AVIF → WebP конвертация** - автоматическое преобразование AVIF в WebP с помощью Sharp
- **Создание WebP версий** - конвертация всех изображений в формат WebP
- **Обновление HTML** - автоматическая замена ссылок на изображения в HTML/CSS

### AVIF обработка:
- Все AVIF файлы автоматически конвертируются в WebP формат
- Качество WebP установлено на 75% для оптимального баланса размера/качества
- HTML и CSS автоматически обновляются для использования .webp расширений
- Исходные AVIF файлы исключаются из стандартной обработки imagemin

## Использование:

### Основные команды:
```bash
# Полный процесс (рекомендуется)
npm run start
# или
npx gulp start

# Только конвертация AVIF в WebP
npx gulp avif-to-webp

# Только создание WebP версий из обычных изображений  
npx gulp convert-to-webp

# Только минификация без AVIF
npx gulp minify-img
```

### Структура папок:
```
src/assets/          - исходные файлы (AVIF, JPG, PNG, etc.)
result/images/       - оптимизированные изображения (кроме AVIF)
result/land/assets/  - все WebP файлы (включая конвертированные AVIF)
result/land/         - финальный HTML с обновленными ссылками
```

### Процесс обработки:
1. **Очистка** - удаление папки result/
2. **Параллельная обработка:**
   - Минификация обычных изображений (JPG, PNG, GIF, SVG)
   - Конвертация AVIF → WebP с помощью Sharp
3. **WebP конвертация** - создание WebP версий из минифицированных изображений
4. **HTML обновление** - замена всех .avif ссылок на .webp в HTML и CSS

### Технические детали:
- **Sharp библиотека** - для высококачественной AVIF → WebP конвертации
- **gulp-replace** - для замены ссылок в HTML/CSS файлах
- **Параллельное выполнение** - задачи minify-img и avif-to-webp выполняются одновременно

## Установка:

```bash
npm install
```

## Структура проекта после обработки:

- Все изображения доступны в формате WebP
- HTML корректно ссылается на WebP файлы
- Поддержка современных браузеров с WebP
- Обратная совместимость для браузеров без WebP поддержки